<div class="main">
    <mat-card class="btns-left" style="min-width: 120px;">
        <mat-card-content>
            <div style="margin-top: 40px;" class="left-1">
                <div class="colection-left">
                    <button mat-stroked-button class="btn-left" color="primary" *ngFor="let item of groups"
                        (click)="onClick(item)">{{item}}</button>
                </div>
            </div>
        </mat-card-content>
    </mat-card>
    <div class="flex" style="width: 100%;flex-direction: column;">
        <mat-card>
            <mat-card-content>
                <div class="flex" style="flex-direction: row;">
                    <div class="flex" style="flex-direction: column;">
                        <div class="full-width">
                            <app-autocomplete [data]="products" *ngIf="products.length>0"
                                (selectTed)="onSelected($event)" (nameText)="onKeyupSanPham($event)"
                                class="max-width490"></app-autocomplete>
                        </div>
                        <div class="full-width center btns-action">
                            <button mat-flat-button class="btn-center" color="primary"
                                (click)="onClickSanPham(item,$event)" (keypress)="keyPress($event,item)"
                                *ngFor="let item of filterProducts">{{item['Name']}}</button>
                        </div>
                    </div>
                    <div class="right flex" style="flex-direction: column; margin-left:8px;max-width:400px">
                        <div>
                            <div class="flex">
                                <div class="flex-1"> <app-autocomplete [data]="khachhangs" *ngIf="khachhangs.length>0"
                                        [options]="optionsKhs" class="left0" (selectTed)="onSelectedKh($event)"
                                        [required]="true" class="max-width490"
                                        style="margin-right:8px"></app-autocomplete></div>
                                <div class="flex-2">
                                    <app-status-order [statusText]="status"
                                        (eventChange)="eventChangeStatus($event)"></app-status-order>
                                </div>
                            </div>
                            <div class="flex groupkhs">
                                <div class="flex" style="flex-grow:1;margin-right:4px">
                                    <mat-button-toggle-group [(ngModel)]="groupGiamgia" (click)="onCal()">
                                        <mat-button-toggle value="vnd">VND</mat-button-toggle>
                                        <mat-button-toggle value="%">%&nbsp;&nbsp;</mat-button-toggle>
                                    </mat-button-toggle-group>
                                    <mat-form-field appearance="fill" style="width: 100px;">
                                        <mat-label>Chiết Khấu</mat-label>
                                        <input matInput placeholder="Chiết Khấu" type="number" min="0"
                                            [(ngModel)]="giamgia" (keyup)="onCal()">
                                    </mat-form-field>
                                </div>
                                <div style="display: inline-grid; margin-right: 0px;" class="flex-2">
                                    <mat-form-field appearance="fill">
                                        <mat-label>Tiền Công</mat-label>
                                        <input matInput placeholder="Tiền Công" type="number" min="0" (keyup)="onCal()"
                                            [(ngModel)]="tiencong">
                                    </mat-form-field>
                                </div>
                                <!-- <div style="margin-right:4px">
                                    <mat-form-field appearance="fill">
                                        <mat-label>Phí Ship</mat-label>
                                        <input matInput placeholder="Tiền Ship" type="number" min="0" (keyup)="onCal()"
                                            [(ngModel)]="phiship">
                                    </mat-form-field>
                                </div> -->

                            </div>

                            <div class="flex">
                                <mat-form-field style="margin-right:4px" class="flex-2">
                                    <mat-label>Chọn Đơn Vị</mat-label>
                                    <mat-select required value="{{selectDv}}">
                                        <mat-option value="1000">1000đ</mat-option>
                                        <mat-option value="100">100đ</mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <mat-form-field class="flex-2">
                                    <mat-label>Chọn Ngày</mat-label>
                                    <input matInput [matDatepicker]="picker" [formControl]="ngay">
                                    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                                    <mat-datepicker #picker></mat-datepicker>
                                </mat-form-field>
                            </div>
                        </div>

                        <div class="show-table" style="flex-grow: 1;">
                            <table class="table-right" [hidden]="orders?.length<1">
                                <thead style="position: sticky;">
                                    <th>#</th>
                                    <th>Tên Hàng</th>
                                    <th>SL</th>
                                    <th>ĐV</th>
                                    <th>ĐG</th>
                                    <th>T. Tiền</th>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let item of orders;let i= index"(blur)="onCal()">
                                        <td><span>{{i+1}}</span></td>
                                        <td><span>{{item['Name']}}</span></td>
                                        <td style="text-align: right;">
                                            <div class="edit" contenteditable
                                            (blur)="onEditTable('soluong',i,$event)"
                                                [innerHTML]="item['Số Lượng']"></div>
                                        </td>
                                        <td style="text-align: right;"><span>{{item['Đơn Vị Tính']}}</span></td>
                                        <td style="text-align: right;">
                                            <div class="edit" contenteditable
                                               (blur)="onEditTable('dongia',i,$event)">{{item['Giá Bán']}}</div>
                                        </td>
                                        <td style="text-align: right;"><span>{{(item['Giá
                                                Bán']*item['Số Lượng'])|number}}</span></td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="2">Tổng</td>
                                        <td colspan="1" style="text-align: right;">
                                            <span>{{sumEnd?.sumCount|number}}</span>
                                        </td>
                                        <td colspan="2"></td>
                                        <td colspan="1" style="text-align: right;">
                                            <span>{{sumEnd?.tt|number}}</span>
                                        </td>
                                    </tr>
                                    <tr *ngIf="sumEnd?.tiencong">
                                        <td colspan="5">Tiền Công</td>
                                        <td colspan="1" style="text-align: right;">
                                            <span>{{sumEnd?.tiencong|number}}</span>
                                        </td>
                                    </tr>
                                    <tr *ngIf="sumEnd?.phiship">
                                        <td colspan="5">Phí Ship</td>
                                        <td colspan="1" style="text-align: right;">
                                            <span>{{sumEnd?.phiship|number}}</span>
                                        </td>
                                    </tr>
                                    <tr *ngIf="sumEnd?.giamgia">
                                        <td colspan="5">Chiết Khấu</td>
                                        <td colspan="1" style="text-align: right;">
                                            <span>{{sumEnd?.giamgia|number}}</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="5">Thanh Toán</td>
                                        <td colspan="1" style="text-align: right;">
                                            <span>{{sumEnd?.thanhtoan|number}}</span>
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                        <div class="flex full-width" style="justify-content: flex-end;">
                            <button mat-flat-button color="primary" mat-dialog-close="Status.Refesh" type="submit"
                                (click)="onSave()" [disabled]="!checkDk">Lưu</button>
                            <button mat-flat-button color="accent" mat-dialog-close="true" (click)="onSavePrint()"
                                [disabled]="!checkDk">Lưu &
                                In</button>
                            <!-- <button mat-flat-button color="warn" mat-dialog-close (click)="onReset()">Reset</button> -->
                        </div>

                    </div>

                </div>


            </mat-card-content>
        </mat-card>
    </div>

</div>